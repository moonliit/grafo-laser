<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Vector Canvas — Freehand Draw</title>

  <!-- your existing visual stylesheet -->
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    /* small local tweaks to ensure layout works even if you don't use the big stylesheet */
    .container {
      max-width: 980px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
      padding-top: 8px;
    }
    .controls {
      width: 100%;
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
    }
    .control-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    #canvas-wrap {
      width: 100%;
      display: flex;
      justify-content: center;
    }
    #canvas {
      width: 768px;
      max-width: 92vw;
      height: 512px;
      background: #fff;
      border-radius: 6px;
    }
    #info {
      min-height: 28px;
      width: 768px;
      max-width: 92vw;
      text-align: center;
    }
    label small {
      display: block;
      font-weight: 400;
      color: var(--muted, #777);
      font-size: 0.85rem;
    }
  </style>
</head>

<body>
  <div class="container">
    <h3>Vector Canvas — freehand strokes</h3>

    <div class="controls">

      <!-- === Left group: clear / compute / send === -->
      <div class="control-group">
        <button id="clearBtn">Clear</button>
        <button id="computeBtn">Compute (server)</button>
        <button id="sendBtn">Send (server)</button>
      </div>

      <div class="control-group">
        <!-- === Tolerance === -->
        <label style="user-select:none;">
          DP tolerance:
          <input id="dpTolerance" type="number" step="0.1" min="0" value="1.0" style="width:80px; margin-left:6px;">
          <small>Sent to server for Douglas–Peucker</small>
        </label>

        <!-- === Animation speed override (optional) === -->
        <label style="user-select:none;">
          Anim speed:
          <input id="animSpeedInput" type="number" step="50" min="50" value="2000"
            style="width:80px; margin-left:6px;"
            oninput="if(window.vcanvas){ window.vcanvas.setAnimSpeed(this.value); }">
          <small>px/sec</small>
        </label>
      </div>

      <div class="control-group">
        <!-- === Highlight all returned graph nodes === -->
        <label style="user-select:none;">
          <input type="checkbox" id="highlightAllNodesChk">
          Highlight all nodes
        </label>

        <!-- === Keep only largest connected component === -->
        <label style="user-select:none;">
          <input type="checkbox" id="keepLargestChk">
          Keep only largest component
        </label>
      </div>
    </div>

    <div id="canvas-wrap">
      <canvas id="canvas" width="768" height="512"></canvas>
    </div>

    <div id="info">Draw with mouse or touch. Use "Compute" to POST polyline(s) to the server.</div>
  </div>

  <script>
    let currentWalk = [];
  </script>
  <script src="draw.js"></script>
  <script src="ws-mqtt.js"></script>
</body>
</html>
